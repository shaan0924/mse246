UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentIA)
UnemploymentID = read.csv('IDUR.csv', header = TRUE)
UnemploymentID$State = "ID"
UnemploymentID = rename(UnemploymentID,UR = IDUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentID)
UnemploymentIL = read.csv('ILUR.csv', header = TRUE)
UnemploymentIL$State = "IL"
UnemploymentIL = rename(UnemploymentIL,UR = ILUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentIL)
UnemploymentIN = read.csv('INUR.csv', header = TRUE)
UnemploymentIN$State = "IN"
UnemploymentIN = rename(UnemploymentIN,UR = INUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentIN)
UnemploymentKS = read.csv('KSUR.csv', header = TRUE)
UnemploymentKS$State = "KS"
UnemploymentKS = rename(UnemploymentKS,UR = KSUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentKS)
UnemploymentKY = read.csv('KYUR.csv', header = TRUE)
UnemploymentKY$State = "KY"
UnemploymentKY = rename(UnemploymentKY,UR = KYUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentKY)
UnemploymentLA = read.csv('LAUR.csv', header = TRUE)
UnemploymentLA$State = "LA"
UnemploymentLA = rename(UnemploymentLA,UR = LAUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentLA)
UnemploymentMA = read.csv('MAUR.csv', header = TRUE)
UnemploymentMA$State = "MA"
UnemploymentMA = rename(UnemploymentMA,UR = MAUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMA)
UnemploymentMD = read.csv('MDUR.csv', header = TRUE)
UnemploymentMD$State = "MD"
UnemploymentMD = rename(UnemploymentMD,UR = MDUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMD)
UnemploymentME = read.csv('MEUR.csv', header = TRUE)
UnemploymentME$State = "ME"
UnemploymentME = rename(UnemploymentME,UR = MEUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentME)
UnemploymentMI = read.csv('MIUR.csv', header = TRUE)
UnemploymentMI$State = "MI"
UnemploymentMI = rename(UnemploymentMI,UR = MIUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMI)
UnemploymentMN = read.csv('MNUR.csv', header = TRUE)
UnemploymentMN$State = "MN"
UnemploymentMN = rename(UnemploymentMN,UR = MNUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMN)
UnemploymentMO = read.csv('MOUR.csv', header = TRUE)
UnemploymentMO$State = "MO"
UnemploymentMO = rename(UnemploymentMO,UR = MOUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMO)
UnemploymentMS = read.csv('MSUR.csv', header = TRUE)
UnemploymentMS$State = "MS"
UnemploymentMS = rename(UnemploymentMS,UR = MSUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMS)
UnemploymentMT = read.csv('MTUR.csv', header = TRUE)
UnemploymentMT$State = "MT"
UnemploymentMT = rename(UnemploymentMT,UR = MTUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentMT)
UnemploymentNC = read.csv('NCUR.csv', header = TRUE)
UnemploymentNC$State = "NC"
UnemploymentNC = rename(UnemploymentNC,UR = NCUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNC)
UnemploymentND = read.csv('NDUR.csv', header = TRUE)
UnemploymentND$State = "ND"
UnemploymentND = rename(UnemploymentND,UR = NDUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentND)
UnemploymentNE = read.csv('NEUR.csv', header = TRUE)
UnemploymentNE$State = "NE"
UnemploymentNE = rename(UnemploymentNE,UR = NEUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNE)
UnemploymentNH = read.csv('NHUR.csv', header = TRUE)
UnemploymentNH$State = "NH"
UnemploymentNH = rename(UnemploymentNH,UR = NHUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNH)
UnemploymentNJ = read.csv('NJUR.csv', header = TRUE)
UnemploymentNJ$State = "NJ"
UnemploymentNJ = rename(UnemploymentNJ,UR = NJUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNJ)
UnemploymentNM = read.csv('NMUR.csv', header = TRUE)
UnemploymentNM$State = "NM"
UnemploymentNM = rename(UnemploymentNM,UR = NMUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNM)
UnemploymentNV = read.csv('NVUR.csv', header = TRUE)
UnemploymentNV$State = "NV"
UnemploymentNV = rename(UnemploymentNV,UR = NVUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNV)
UnemploymentNY = read.csv('NYUR.csv', header = TRUE)
UnemploymentNY$State = "NY"
UnemploymentNY = rename(UnemploymentNY,UR = NYUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentNY)
UnemploymentOH = read.csv('OHUR.csv', header = TRUE)
UnemploymentOH$State = "OH"
UnemploymentOH = rename(UnemploymentOH,UR = OHUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentOH)
UnemploymentOK = read.csv('OKUR.csv', header = TRUE)
UnemploymentOK$State = "OK"
UnemploymentOK = rename(UnemploymentOK,UR = OKUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentOK)
UnemploymentOR = read.csv('ORUR.csv', header = TRUE)
UnemploymentOR$State = "OR"
UnemploymentOR = rename(UnemploymentOR,UR = ORUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentOR)
UnemploymentPA = read.csv('PAUR.csv', header = TRUE)
UnemploymentPA$State = "PA"
UnemploymentPA = rename(UnemploymentPA,UR = PAUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentPA)
UnemploymentPR = read.csv('PRURN.csv', header = TRUE)
UnemploymentPR$State = "PR"
UnemploymentPR = rename(UnemploymentPR,UR = PRURN)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentPR)
UnemploymentRI = read.csv('RIUR.csv', header = TRUE)
UnemploymentRI$State = "RI"
UnemploymentRI = rename(UnemploymentRI,UR = RIUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentRI)
UnemploymentSC = read.csv('SCUR.csv', header = TRUE)
UnemploymentSC$State = "SC"
UnemploymentSC = rename(UnemploymentSC,UR = SCUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentSC)
UnemploymentSD = read.csv('SDUR.csv', header = TRUE)
UnemploymentSD$State = "SD"
UnemploymentSD = rename(UnemploymentSD,UR = SDUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentSD)
UnemploymentTN = read.csv('TNUR.csv', header = TRUE)
UnemploymentTN$State = "TN"
UnemploymentTN = rename(UnemploymentTN,UR = TNUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentTN)
UnemploymentTX = read.csv('TXUR.csv', header = TRUE)
UnemploymentTX$State = "TX"
UnemploymentTX = rename(UnemploymentTX,UR = TXUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentTX)
UnemploymentUT = read.csv('UTUR.csv', header = TRUE)
UnemploymentUT$State = "UT"
UnemploymentUT = rename(UnemploymentUT,UR = UTUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentUT)
UnemploymentVA = read.csv('VAUR.csv', header = TRUE)
UnemploymentVA$State = "VA"
UnemploymentVA = rename(UnemploymentVA,UR = VAUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentVA)
UnemploymentVT = read.csv('VTUR.csv', header = TRUE)
UnemploymentVT$State = "VT"
UnemploymentVT = rename(UnemploymentVT,UR = VTUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentVT)
UnemploymentWA = read.csv('WAUR.csv', header = TRUE)
UnemploymentWA$State = "WA"
UnemploymentWA = rename(UnemploymentWA,UR = WAUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentWA)
UnemploymentWI = read.csv('WIUR.csv', header = TRUE)
UnemploymentWI$State = "WI"
UnemploymentWI = rename(UnemploymentWI,UR = WIUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentWI)
UnemploymentWV = read.csv('WVUR.csv', header = TRUE)
UnemploymentWV$State = "WV"
UnemploymentWV = rename(UnemploymentWV,UR = WVUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentWV)
UnemploymentWY = read.csv('WYUR.csv', header = TRUE)
UnemploymentWY$State = "WY"
UnemploymentWY = rename(UnemploymentWY,UR = WYUR)
UnemploymentUSbyState = rbind.fill(UnemploymentUSbyState, UnemploymentWY)
View(UnemploymentUSbyState)
write.csv(UnemploymentUSbyState, "StateUR.csv", row.names = FALSE)
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
######################################
#GrossApproval vs. Annual Default Rate
temp = raw_data
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
raw_data = raw_data[!(raw_data$ProjectState %in% unique(unidentified.states)),]
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, ApprovalDate = DATE)
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, ApprovalDate = DATE, ProjectState = State)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","ApprovalDate"))
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
raw_data = raw_data[!(raw_data$ProjectState %in% unique(unidentified.states)),]
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
raw_data = raw_data[!(raw_data$ProjectState %in% unique(unidentified.states)),]
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
raw_data = raw_data[!(raw_data$ProjectState %in% unique(unidentified.states)),]
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
#15 occurances of different states or NA thus delete those loans
unidentified.states = !(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))
#15 occurances of different states or NA thus delete those loans
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% colnames(UnemploymentUSbyState))]
unidentified.states = raw_data$ProjectState[!(raw_data$ProjectState %in% unique(UnemploymentUSbyState$State))]
unidentified.states = unique(raw_data$ProjectState[!(raw_data$ProjectState %in% unique(UnemploymentUSbyState$State))])
raw_data = raw_data[!(raw_data$ProjectState %in% unidentified.states,]
raw_data = raw_data[!(raw_data$ProjectState %in% unidentified.states),]
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, ApprovalDate = DATE, ProjectState = State)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","ApprovalDate"))
View(temp)
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
unidentified.states = unique(raw_data$ProjectState[!(raw_data$ProjectState %in% unique(UnemploymentUSbyState$State))])
raw_data = raw_data[!(raw_data$ProjectState %in% unidentified.states),]
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, ApprovalDate = DATE, ProjectState = State)
temp = merge(x=temp.data,y=tempUR, all.x = TRUE)
View(temp)
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, month.bin = DATE, ProjectState = State)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","ApprovalDate"), all.x = TRUE)
View(temp.data)
View(temp)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","month.bin"), all.x = TRUE)
View(UnemploymentUSbyState)
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
unidentified.states = unique(raw_data$ProjectState[!(raw_data$ProjectState %in% unique(UnemploymentUSbyState$State))])
raw_data = raw_data[!(raw_data$ProjectState %in% unidentified.states),]
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, month.bin = DATE, ProjectState = State, URinProjectState = UR)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","month.bin"), all.x = TRUE)
View(temp)
unidentified.states.Borr = unique(raw_data$BorrState[!(raw_data$BorrState %in% unique(UnemploymentUSbyState$State))])
#UnemploymentInBorrowerState
tempUR = rename(UnemploymentUSbyState, month.bin = DATE, BorrState = State, URinBorrState = UR)
#UnemploymentInBorrowerState
tempUR.Borr = rename(UnemploymentUSbyState, month.bin = DATE, BorrState = State, URinBorrState = UR)
temp = merge(x=temp,y=tempUR.Borr,by=c("BorrState","month.bin"))
View(temp)
raw_data = subset(temp, select = -month.bin)
View(raw_data)
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
############
#IMPORTS
############
#GDP Import
GDP = read.csv("GDP.csv")
#FedFunds Import
FEDFUNDS = read.csv("FEDFUNDS.csv")
#SP500 Import
SP500 = getSymbols("^GSPC",from = "1990-01-31",to = "2014-12-31", periodicity = 'monthly', auto.assign = FALSE)
#CPI Import (Consumer Price Index for All Urban Consumers: All Items in U.S. City Average)
CPI = read.csv("CPIAUCSL.csv")
#Unemployment
UnemploymentUSbyState = read.csv('StateUR.csv', header = TRUE)
##############
#Preprocessing
##############
raw_data = raw_data[!(raw_data$LoanStatus=="CANCLD" | raw_data$LoanStatus=="EXEMPT"),]
unidentified.states = unique(raw_data$ProjectState[!(raw_data$ProjectState %in% unique(UnemploymentUSbyState$State))])
raw_data = raw_data[!(raw_data$ProjectState %in% unidentified.states),]
unidentified.states.Borr = unique(raw_data$BorrState[!(raw_data$BorrState %in% unique(UnemploymentUSbyState$State))])
###################################
#UnemploymentInProjectState
raw_data$ApprovalDate = as.Date(raw_data$ApprovalDate)
temp.data = transform(raw_data, month.bin = cut(ApprovalDate, breaks = "month"))
tempUR = rename(UnemploymentUSbyState, month.bin = DATE, ProjectState = State, URinProjectState = UR)
temp = merge(x=temp.data,y=tempUR,by=c("ProjectState","month.bin"))
#UnemploymentInBorrowerState
tempUR.Borr = rename(UnemploymentUSbyState, month.bin = DATE, BorrState = State, URinBorrState = UR)
temp = merge(x=temp,y=tempUR.Borr,by=c("BorrState","month.bin"))
raw_data = subset(temp, select = -month.bin)
View(raw_data)
library(lubridate)
library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
#setwd("/Users/jackparkin/Desktop/MS&E 246/Project/mse246")
setwd("/Users/sihguat/Desktop/MSE_246/mse246")
############
#Data Import
############
#raw_data_xlxs = read_excel('SBA Loan data .xlsx')
#write.csv(raw_data_xlxs,"SBA Loan data .csv", row.names = FALSE)
raw_data = read.csv("SBA Loan data .csv", header = TRUE)
######################################
#GrossApproval vs. Annual Default Rate
temp = raw_data
temp = transform(raw_data, bin = cut(GrossApproval, breaks= c(0,100000, 250000, 500000, 750000, 1000000, 2000000, 10000000)))
raw_data$Size[temp$bin == "(0,1e+05]"] = "<$100k"
raw_data$Size[temp$bin == "(1e+05,2.5e+05]"] = "$100k-250K"
raw_data$Size[temp$bin == "(2.5e+05,5e+05]"] = "$250k-500k"
raw_data$Size[temp$bin == "(5e+05,7.5e+05]"] = "$500k-750k"
raw_data$Size[temp$bin == "(7.5e+05,1e+07]"] = "$750k+"
raw_data$Size[temp$bin == "(7.5e+05,1e+06]"] = "$750k-$1M"
raw_data$Size[temp$bin == "(1e+06,2e+0+6]"] = "$1M-$2M"
raw_data$Size[temp$bin == "(2e+06,1e+07]"] = "$2M+"
temp = raw_data %>% drop_na(Size) %>% group_by(Size) %>% summarise("Volume" = sum(GrossApproval))
ggplot(data=temp, aes(x=Size, y=Volume, color = Size)) + geom_bar(stat="identity") + ggtitle("Total Loan Volume by Loan Size") + xlab("Size") + ylab("Total Loan Volume")
